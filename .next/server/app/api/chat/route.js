"use strict";(()=>{var e={};e.id=744,e.ids=[744],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},5315:e=>{e.exports=require("path")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},2623:e=>{e.exports=require("worker_threads")},1568:e=>{e.exports=require("zlib")},7561:e=>{e.exports=require("node:fs")},4492:e=>{e.exports=require("node:stream")},6555:(e,r,s)=>{s.r(r),s.d(r,{originalPathname:()=>g,patchFetch:()=>O,requestAsyncStorage:()=>h,routeModule:()=>E,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m});var t={};s.r(t),s.d(t,{POST:()=>d});var o=s(9303),n=s(8716),a=s(670),i=s(7070),c=s(7214),l=s(4333),u=s(3799);console.log("Chat route environment check:"),console.log("OPENAI_API_KEY:",process.env.OPENAI_API_KEY?"Present":"Missing"),console.log("GOOGLE_PROJECT_ID:",process.env.GOOGLE_PROJECT_ID?"Present":"Missing"),console.log("GOOGLE_CLIENT_EMAIL:",process.env.GOOGLE_CLIENT_EMAIL?"Present":"Missing"),console.log("GOOGLE_PRIVATE_KEY:",process.env.GOOGLE_PRIVATE_KEY?"Present":"Missing");try{(0,l.s)()}catch(e){throw console.error("Environment validation failed:",e),e}let p=new c.ZP({apiKey:process.env.OPENAI_API_KEY});async function d(e){try{let{message:r,topic:s}=await e.json(),t=`You are a friendly Danish acquaintance named Danish Buddy who helps users learn Danish. 
You communicate primarily in Danish, and you always include English translations in parentheses. 
Current conversation topic: ${s}. 
You have casual, personal opinions on this topicâ€”just like a real person would. 
If the user makes language mistakes, correct them gently in Danish without breaking the conversational flow. 
Never say that you are an AI or language model. 
Keep your responses natural, polite, and conversational, and stay politically correct.`,o=(await p.chat.completions.create({model:"gpt-4",messages:[{role:"system",content:t},{role:"user",content:r}],temperature:.7})).choices[0].message.content,n=o,a="";return o?.includes("(")&&o?.includes(")")&&(n=o.split("(")[0].trim(),a=o.match(/\((.*?)\)/)?.[1]||""),i.NextResponse.json({message:{role:"assistant",content:n,translation:a}})}catch(e){return(0,u.zG)(e)}}let E=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"C:\\Users\\aliso\\danish-buddy\\src\\app\\api\\chat\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:v}=E,g="/api/chat/route";function O(){return(0,a.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},3799:(e,r,s)=>{s.d(r,{zG:()=>n});var t=s(7070);class o extends Error{constructor(e,r,s){super(e),this.code=r,this.details=s,this.name="SpeechServiceError"}}function n(e){return e instanceof o?t.NextResponse.json({error:e.message,code:e.code},{status:500}):e instanceof Error?t.NextResponse.json({error:"Internal Server Error",code:"INTERNAL_ERROR",details:void 0},{status:500}):t.NextResponse.json({error:"Unknown Error",code:"UNKNOWN_ERROR"},{status:500})}},4333:(e,r,s)=>{s.d(r,{s:()=>o});class t extends Error{constructor(e,r=500,s){super(e),this.statusCode=r,this.details=s,this.name="APIError"}}function o(){let e=["OPENAI_API_KEY","GOOGLE_PROJECT_ID","GOOGLE_CLIENT_EMAIL","GOOGLE_PRIVATE_KEY"];console.log("Environment variables check:"),e.forEach(e=>{console.log(`${e}: ${process.env[e]?"Present":"Missing"}`)});let r=e.filter(e=>!process.env[e]);if(r.length>0)throw new t(`Missing required environment variables: ${r.join(", ")}`,500,{missingVars:r});if(!process.env.GOOGLE_PRIVATE_KEY?.includes("-----BEGIN PRIVATE KEY-----"))throw new t("Invalid Google Cloud private key format",500,{privateKey:process.env.GOOGLE_PRIVATE_KEY?"Present but invalid format":"Missing"})}}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[948,972,214],()=>s(6555));module.exports=t})();